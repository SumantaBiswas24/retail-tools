<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retail Buying Decision Tool</title>

<style>
:root{
  --good:#22c55e;
  --risk:#facc15;
  --bad:#ef4444;
  --bg:#f8fafc;
  --card:#ffffff;
}

body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:var(--bg);
  margin:0;
  padding:1rem;
}

.container{
  max-width:600px;
  margin:auto;
}

h2{
  text-align:center;
  margin-bottom:1rem;
}

.card{
  background:var(--card);
  padding:1.2rem;
  border-radius:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
}

/* ===== GRID FIX ===== */
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-bottom:14px;
}

label{
  font-size:.8rem;
  color:#64748b;
  display:block;
  margin-bottom:.3rem;
}

input, select{
  width:100%;
  padding:.7rem;
  border-radius:10px;
  border:1px solid #cbd5e1;
  font-size:1rem;
  box-sizing:border-box;
}

/* Toggle */
.toggle{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
  margin-top:6px;
}

.toggle button{
  padding:.5rem;
  border-radius:8px;
  border:1px solid #cbd5e1;
  background:#fff;
  cursor:pointer;
  font-weight:600;
}

.toggle button.active{
  background:#2563eb;
  color:#fff;
  border-color:#2563eb;
}

/* Buttons */
button.action{
  width:100%;
  padding:.9rem;
  border:none;
  border-radius:14px;
  font-weight:700;
  cursor:pointer;
  background:#0f172a;
  color:#fff;
  margin-top:.6rem;
}

button.whatsapp{
  background:#25D366;
}

/* Result */
.result{
  text-align:center;
  margin-top:1rem;
}

.score{
  font-size:2rem;
  font-weight:800;
}

.good{color:var(--good);}
.risk{color:#a16207;}
.bad{color:var(--bad);}

.badge{
  display:inline-block;
  padding:.3rem .6rem;
  border-radius:6px;
  font-weight:700;
  margin-top:.4rem;
}

.bg-good{background:#dcfce7;color:#166534;}
.bg-risk{background:#fef9c3;color:#854d0e;}
.bg-bad{background:#fee2e2;color:#991b1b;}

/* History */
.history{
  margin-top:1.2rem;
}

.history-item{
  background:#fff;
  padding:.6rem;
  border-radius:10px;
  margin-bottom:.5rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 1px 3px rgba(0,0,0,.1);
}

small{color:#64748b;}

/* Mobile */
@media(max-width:600px){
  .row{grid-template-columns:1fr;}
}
</style>
</head>

<body>

<div class="container">
<h2>ðŸ§  Retail Buying Decision</h2>

<div class="card">

<!-- ROW 1 -->
<div class="row">
  <div>
    <label>Buying Price</label>
    <input type="number" id="buyPrice" placeholder="â‚¹">
  </div>
  <div>
    <label>Selling Price</label>
    <input type="number" id="sellPrice" placeholder="â‚¹">
  </div>
</div>

<!-- ROW 2 -->
<div class="row">
  <div>
    <label>GST %</label>
    <select id="gst">
      <option value="0">0%</option>
      <option value="5">5%</option>
      <option value="12">12%</option>
      <option value="18">18%</option>
    </select>
  </div>
  <div>
    <label>Other Expenses</label>
    <input type="number" id="expense" placeholder="â‚¹ / %">
    <div class="toggle">
      <button class="active" onclick="setExpenseType(this,'amount')">â‚¹</button>
      <button onclick="setExpenseType(this,'percent')">%</button>
    </div>
  </div>
</div>

<!-- ROW 3 -->
<div class="row">
  <div>
    <label>Category</label>
    <select id="category" onchange="loadProducts()">
      <option value="">Select</option>
      <option value="shirts">Shirts</option>
      <option value="jeans">Jeans</option>
      <option value="tshirt">T-Shirts</option>
      <option value="accessories">Accessories</option>
      <option value="footwear">Footwear</option>
    </select>
  </div>
  <div>
    <label>Product</label>
    <select id="product">
      <option value="">Select product</option>
    </select>
  </div>
</div>

<button class="action" onclick="analyze()">Analyze Buying</button>
<button class="action whatsapp" onclick="shareWhatsApp()">Share on WhatsApp</button>

<div class="result" id="output"></div>

</div>

<div class="history">
  <h4>Past Decisions</h4>
  <div id="history"></div>
</div>

</div>

<script>
let expenseType="amount";

const products={
  shirts:["Formal Shirt","Casual Shirt","Cotton Shirt","Other"],
  jeans:["Slim Fit","Regular Fit","Stretch Jeans","Other"],
  tshirt:["Round Neck","Polo","Oversized","Other"],
  accessories:["Belt","Wallet","Cap","Other"],
  footwear:["Shoes","Sandals","Slippers","Other"]
};

const rules={
  shirts:35,
  jeans:40,
  tshirt:45,
  accessories:50,
  footwear:30
};

function setExpenseType(btn,type){
  expenseType=type;
  btn.parentElement.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
}

function loadProducts(){
  const cat=document.getElementById('category').value;
  const prod=document.getElementById('product');
  prod.innerHTML='<option value="">Select product</option>';
  if(!products[cat]) return;
  products[cat].forEach(p=>{
    const o=document.createElement('option');
    o.value=p;
    o.textContent=p;
    prod.appendChild(o);
  });
}

function analyze(){
  const buy=+document.getElementById('buyPrice').value||0;
  const sell=+document.getElementById('sellPrice').value||0;
  const gst=+document.getElementById('gst').value||0;
  const exp=+document.getElementById('expense').value||0;
  const cat=document.getElementById('category').value;
  const prod=document.getElementById('product').value;

  if(!buy||!sell||!cat||!prod) return;

  let cost=buy+(buy*gst/100);
  if(expenseType==="amount") cost+=exp;
  else cost+=buy*(exp/100);

  const profit=sell-cost;
  const margin=(profit/sell)*100;
  const req=rules[cat];

  let score=Math.min(margin,60);
  if(gst>12) score-=10;
  if(profit<100) score-=10;
  if(margin<req) score-=20;
  score=Math.max(0,Math.round(score));

  let status,qty,cls;
  if(margin>=req+5){status="GOOD BUY";qty="20â€“30 units";cls="good";}
  else if(margin>=req){status="RISKY BUY";qty="8â€“15 units";cls="risk";}
  else{status="AVOID BUYING";qty="0 units";cls="bad";}

  document.getElementById('output').innerHTML=`
    <div class="score ${cls}">${score}/100</div>
    <div class="badge bg-${cls}">${status}</div>
    <p><b>Category:</b> ${cat} | <b>Product:</b> ${prod}</p>
    <p><b>Final Cost:</b> â‚¹${cost.toFixed(0)}</p>
    <p><b>Profit:</b> â‚¹${profit.toFixed(0)}</p>
    <p><b>Margin:</b> ${margin.toFixed(1)}%</p>
    <p><b>Recommended Qty:</b> ${qty}</p>
  `;

  saveHistory({cat,prod,status});
  renderHistory();
}

function shareWhatsApp(){
  const text=document.getElementById('output').innerText;
  if(!text){alert("Please analyze first");return;}
  const url=`https://wa.me/?text=${encodeURIComponent(text)}`;
  window.open(url,"_blank");
}

function saveHistory(item){
  let h=JSON.parse(localStorage.getItem("buyHistory"))||[];
  h.unshift({...item,id:Date.now()});
  h=h.slice(0,20);
  localStorage.setItem("buyHistory",JSON.stringify(h));
}

function renderHistory(){
  let h=JSON.parse(localStorage.getItem("buyHistory"))||[];
  document.getElementById('history').innerHTML=h.map(i=>`
    <div class="history-item">
      <div><b>${i.cat}</b><br><small>${i.prod}</small></div>
      <div class="badge ${
        i.status.includes("GOOD")?"bg-good":
        i.status.includes("RISK")?"bg-risk":"bg-bad"
      }">${i.status}</div>
    </div>
  `).join('');
}

renderHistory();
</script>

</body>
</html>
